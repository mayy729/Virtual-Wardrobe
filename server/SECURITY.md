# 安全指南

## 当前安全状态

### ✅ 已实现的安全措施

1. **密码哈希**：使用 SHA-256 哈希（需要升级到 bcrypt）
2. **Token 生成**：使用 `crypto.randomBytes` 生成安全的随机 token
3. **身份验证中间件**：保护 API 端点
4. **输入验证**：用户名和密码长度验证
5. **用户数据隔离**：每个用户的数据独立存储

### ⚠️ 需要改进的安全措施

1. **密码加密**：SHA-256 没有加盐，容易被彩虹表攻击
2. **CORS 配置**：当前允许所有来源，应该限制为特定域名
3. **速率限制**：没有防止暴力破解的保护
4. **HTTPS 强制**：应该强制使用 HTTPS
5. **会话过期**：需要更严格的会话管理
6. **输入清理**：需要防止 XSS 和 SQL 注入（虽然使用 MongoDB，但仍需注意）

## 安全最佳实践

### 1. 密码安全
- ✅ 使用 bcrypt 或 argon2（比 SHA-256 更安全）
- ✅ 添加盐值（salt）防止彩虹表攻击
- ✅ 密码最小长度要求（当前：6 字符，建议：8+ 字符）
- ✅ 密码复杂度要求（可选）

### 2. 数据传输安全
- ✅ 使用 HTTPS（生产环境必须）
- ✅ 敏感数据不通过 URL 传递
- ✅ Token 存储在安全的 HTTP-only cookie 或 localStorage

### 3. 身份验证安全
- ✅ Token 过期时间（当前：24 小时）
- ✅ 安全的 Token 生成
- ✅ 登出时清除 Token

### 4. API 安全
- ✅ CORS 限制到特定域名
- ✅ 速率限制（防止暴力破解）
- ✅ 输入验证和清理
- ✅ 错误消息不泄露敏感信息

### 5. 数据安全
- ✅ MongoDB 连接字符串加密存储
- ✅ 环境变量保护敏感信息
- ✅ 用户数据隔离

## 部署安全检查清单

- [ ] 使用 HTTPS（Render 自动提供）
- [ ] 设置 CORS 为特定域名
- [ ] 启用速率限制
- [ ] 升级密码哈希到 bcrypt
- [ ] 设置强密码策略
- [ ] 定期更新依赖包
- [ ] 监控异常登录尝试
- [ ] 备份数据

## 用户建议

1. **使用强密码**：至少 8 个字符，包含大小写字母、数字和特殊字符
2. **不要共享密码**：每个账户使用唯一密码
3. **定期更改密码**：建议每 3-6 个月更改一次
4. **使用 HTTPS**：确保连接是加密的（浏览器地址栏显示 🔒）
5. **登出公共设备**：使用公共电脑后记得登出

